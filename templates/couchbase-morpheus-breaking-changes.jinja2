{% macro generate_issue_table(issues, title, components, suffix) %}
{% set filtered_issues = issues | filter_by_component(components) %}

{% if filtered_issues | length > 0 %}
=== {{ title }}

[#breaking-changes-{{ user_settings.fields.release_text | replace_dots('') }}-{{ suffix }}]

{% for issue in filtered_issues %}

*{{ url_with_jira(user_settings.release_set.url, issue.key) }}*::

{% if not issue.fields['customfield_11402']  %}
{{ issue.fields.ai_summary or '{empty}' }}

{% if issue.fields.ai_service is defined %}
// Generated by [{{ issue.fields.ai_service['name']}}:{{ issue.fields.ai_service['model'] }}]
{% endif %}

{% else %}
{{ issue.raw['fields']['customfield_11402'] | replace("|", "\|") | replace("{{", "`")  | replace("}}", "`") }}
{% endif %}
{% endfor %}
{% endif %}
{% endmacro %}


{% macro generate_uncategorized_issue_table(issues, title, components, suffix) %}
{% set filtered_issues = issues | filter_out_by_component(components) %}

{% if filtered_issues | length > 0 %}
=== {{ title }}

[#breaking-changes-{{ user_settings.fields.release_text | replace_dots('') }}-{{ suffix }}]

{% for issue in filtered_issues %}

*{{ url_with_jira(user_settings.release_set.url, issue.key) }}*::

{% if issue.fields['customfield_11402'] is not none and issue.fields['customfield_11402'] | length > 0 %}
{{ issue.raw['fields']['customfield_11402'] | replace("|", "\|") | replace("{{", "`")  | replace("}}", "`") }}
{% else %}
{{ issue.fields.ai_summary or '{empty}' }}

{% if issue.fields.ai_service is defined %}
// Generated by [{{ issue.fields.ai_service['name']}}:{{ issue.fields.ai_service['model'] }}]
{% endif %}

{% endif %}
{% endfor %}
{% endif %}
{% endmacro %}



[#breaking-changes-{{ user_settings.fields.release_text | replace_dots('') }}]
== Breaking changes {{ user_settings.fields.release_text }} ({{ user_settings.fields.release_date }})

Couchbase Server {{ user_settings.fields.release_text }} was released in {{ user_settings.fields.release_date }}.
This maintenance release contains the following breaking changes:

{% include "docs-server-components.jinja2" %}
